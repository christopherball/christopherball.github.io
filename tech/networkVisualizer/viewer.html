<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Network Visualizer</title>

    <script src="https://christopherball.github.io/tech/networkVisualizer/jquery.min.js"></script>
    <script src="https://christopherball.github.io/tech/networkVisualizer/vis-network.min.js"></script>

    <style type="text/css">
      body,
      html {
        font: 10pt sans;
        line-height: 1.5em;
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        color: #4d4d4d;
        box-sizing: border-box;
        overflow: hidden;
      }

      #mynetwork {
        width: 100%;
        height: 100%;
        box-sizing: border-box;
      }
    </style>
  </head>
  <body>
    <div id="mynetwork"></div>

    <script type="text/javascript">
      var container = document.getElementById("mynetwork");
      var options = {
        physics: {
          stabilization: false,
          barnesHut: {
            springLength: 200,
          },
        },
        nodes: {
          color: {
              highlight: {
                background: 'yellow',
                border: 'black',
              },
          },
        },
      };

      var data = {};
      var network = new vis.Network(container, data, options);
      let params = Object.fromEntries(new URLSearchParams(location.search));

      network.on("beforeDrawing",  function(ctx) {
        ctx.save();
        ctx.setTransform(1, 0, 0, 1, 0, 0);
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height)
        ctx.restore();
      });

      function loadNetwork(chosenValue) {
        var url = "";
        const ms = Date.now();

        switch(chosenValue) {
          case "Default": 
            url = "https://christopherball.github.io/tech/networkVisualizer/dot/default.dot";
            break;
          case "Book": 
            url = "https://christopherball.github.io/tech/networkVisualizer/dot/book.dot";
            break;
          case "TLK":
            url = "https://christopherball.github.io/tech/networkVisualizer/dot/TLK.dot";
            break;
          default:
            url = "https://christopherball.github.io/tech/networkVisualizer/dot/default.dot";
        }

        fetch(url + "?cacheBust=" + ms)
          .then(r => r.text())
          .then( t => {
            draw(t);
          });
      }

      loadNetwork(params.load);

      function draw(t) {
        data = vis.parseDOTNetwork(t);
        network.setData(data);
      }
    </script>
  </body>
</html>
